# 推荐系统基础

**1、推荐系统的转化流程是什么？**

先曝光，后点击，点击以后分为滑动到底+评论，点赞，收藏，转发四种（抖音没有曝光和点击）

**2、推荐系统的短期消费指标？**

点击率、点赞率、收藏率、转发率，点击率是点击次数/曝光次数，后三个是除以点击次数

阅读完成率=滑动到底次数/点击次数×f（归一化函数，与笔记长度有关）

**3、推荐系统的北极星指标（最关键指标）？**

日活/月活用户数（DAU/MAU），人均使用推荐时长，人均阅读笔记数量，发布渗透率（当日发布人数/日活人数）和人均发布量（当日发布笔记数/日活人数）

最核心的指标是DAU和留存（LT7、LT30，代表7天/30天内用户对app的使用率）

北极星指标有利于提升内容多样性，提高用户的活性和数量

**4、推荐系统实验流程分为哪几种？**

离线实验（线下，无用户交互）

小流量A/B测试、全流量上线（线上，有用户交互）

**5、推荐系统的链路（重点）**

过程： 召回——>粗排——>精排——>重排

物品数：几亿——>几千——>几百——>几百——>几十

召回：从物品数据库中快速取回一些物品

粗排：用规模较小的机器学习模型对笔记打分，得到几百篇笔记（需要截断）

精排：用大规模神经网络对粗排的几百篇笔记打分，反映用户兴趣（不用截断）

重排：根据精排分数和多样性分数抽样得到几十篇笔记，并把内容打散

链路当中哪个被公司投入的资源最多：精排

**6、A/B测试的分桶方式是什么？**

先用哈希函数把用户ID映射到某个区间内整数，然后采用随机分桶，把n位用户（这些整数）分到b个桶。设置一个桶作为对照组，其它若干桶作为实验组，实验组指标明显优于对照组，将策略推全。

**7、分层实验的目的是什么？两个原则？**

目的是增加同时做的实验数量，解决流量不够用的问题

两个原则：同层互斥（一个桶不受多种实验策略影响），不同层正交（相互独立）

> **自己的想法**
>
> 目的：1️⃣ 在多个实验同时运行的场景下，确保每个实验的有效性和可控性，避免实验之间“串扰”或“污染”。2️⃣ 增加同时做的实验数量，解决流量不够用的问题。
>
> 两个原则：
>
> - 同层互斥：即一个user不能同时出现在层中的不同桶中；
> - 不同层正交：即不同层之间，如果实验相互独立（比如粗排模型实验和召回模型实验之间不会相互干扰，就视为相互独立的），则可以共用同一批流量；反之如果不独立（比如要对比不同粗排模型，这些本来就是互斥的），则必须流量分流，不同分支的流量测试不同的模型。
>
> 实验步骤：
>
> 1️⃣ 不同类型的测试单独化作一层，确保不同层之间独立，这样每一层获得100%的流量；
>
> 2️⃣ 在该层中，不同实验之间是互斥的，该层中的不同实验对应哈希之后的不同流量区段；
>
> ⚠️‼️ 注意：**但是GPT等好像不这样认为，GPT认为应该先分流给不同层，然后不同层内之间可以再次分流，这样可以保证实验对象（流量）只受一种实验影响，这样可以很好地判断是哪个策略导致了流量的变化。**

**8、holdout的策略？**

holdout是考虑整个推荐系统对业务指标的贡献，取10%用户作为holdout桶作为对照，对剩余90%用户进行实验，90%实验桶和10%holdout桶的diff就为整个部门业务指标收益。

每个考核周期结束后清除holdout桶，将实验推全到100%用户，下一周期重新随机划分得到新的holdout桶，开始新一轮考核。

**9、反转实验的必要性？实验方式？一个考核周期结束后对反转桶有无影响？**

必要性：有的指标需要长期观测才能获得稳定指标，反转实验既保证了新策略推全，也可以长期观测实验指标。

方式：推全的新层开个旧策略的桶，对比观测新策略和旧策略的diff。

一个考核周期结束后，会清除holdout桶，但只要反转实验没有结束，反转桶就不会受影响，反转结束后才把新策略用到反转桶上，实验得到真正推全。

**10、推荐系统的架构分为哪两方面？**

功能架构和数据架构，功能架构就是推荐系统链路中的四个过程，数据架构运用Lambda架构，包含离线层、近线层、在线层。

**11、冷数据和热数据的含义？**

冷数据：已经存储在Hadoop分布式文件系统（HDFS）的数据日志

热数据：没来得及生成用户日志的数据，或没来得及落盘在HDFS上的数据

**12、Lambda架构如何处理数据？**

离线层：冷数据在该层进行定时批量计算，每小时统计每个视频的曝光数、点击数并保存结果，一周的CTR就是这168（24x7）个中间结果的汇总，采用Hadoop、Spark、Flink等大数据框架完成。

近线层：离线层计算完毕后视频CTR还在HDFS上，HDFS不利于快速读写，因此将离线批量计算的结果导入Cassandra、Redis这种键值型数据库，缓存离线层结果，便于快速读取。

在线层：离线层中的统计存在时间缺口（例如1-2小时），因此需要让热数据在该层进行流式更新，弥补时间缺口下的数据，计算结果也缓存在Redis中。该层采用Storm、Flink等流式计算框架。

**13、推广搜的作用？有哪些相同点？**

推荐和搜索：负责留住用户，生产流量；广告：负责将流量变现。

相同点：功能架构上都遵循召回粗筛，排序模块精挑细选；数据架构都遵循Lambda结构，算法上三者很多都通用，且都需要很强的个性化。

**14、推荐和搜索的区别？**

第一个区别：用户表达意图的方式不同，搜索依赖输入的查询语句显示表达意图，推荐无需用户显示表达意图，而是通过系统长期观察猜测用户意图。

第二个区别：搜索对结果准确性更加严格，搜索的结果是交集，推荐的结果是并集。

**15、推搜和广告的区别?**

广告对用户的行为考察更多：点击、下载、注册、成功下单等，行为链比推搜更深，且广告和利益相关，因此对预测的精度有绝对准确性的要求。